---
title: "Final Project"
author: "Sanyukta Ghai"
date: "`r format(Sys.time(), '%B %d, %Y')`"
output: 
  html_document:
    toc: true    
    toc_depth: 2    
    toc_float: TRUE
---

```{r echo = FALSE}
# Course: BUAN 5210
# Title: Quick Project 1 Technical Appendix
# Purpose: Analyzing office sales data 
# Date: Jan 26, 2019
# Author: Nancy Jain and Sanyukta Ghai
```


Clear environment
=================

```{r, warning= FALSE, message= FALSE}
# Clear environment of variables and functions
rm(list = ls(all = TRUE)) 
# Clear environmet of packages
if(is.null(sessionInfo()$otherPkgs) == FALSE)lapply(paste("package:", names(sessionInfo()$otherPkgs), sep=""), detach, character.only = TRUE, unload = TRUE)
```


Load packages 
==============

```{r, warning= FALSE, message= FALSE }
# Load libraries
library(tidyverse) # tidyverse syntax
library(ggplot2) # Neat Graphs 
library(kableExtra) # Pretty HTML Tables
library(corrplot) # Pairwise correlation plot
```


Load data
=========================================
This dataset contains a list of video games with sales greater than 100,000 copies and is obtained from kaggle.com. It represents video games sales from a website vgchartz.com from 1980 to 2016.

```{r}
#Load Data
video_games_raw_data <- read.csv("../raw_data/vgsales.csv")

str(video_games_raw_data)

summary(video_games_raw_data)

```
### Observations

+ Table contains 16598 observations of 11 variables  
+ 5 factor variables - Name, Platform, Year, Genre, Publisher  
+ 6 numeric variables - Rank, NA_Sales, EU_Sales, JP_Sales, Other_Sales, Global_Sales

### Filter data based on our scope

```{r}
# Years from 2000 onwards
# Remove Rank column
# Consider only US Sales  
# Remove rows with 0 sales
video_games_data <- video_games_raw_data %>%
  select(-c(Rank, EU_Sales, JP_Sales, Other_Sales, Global_Sales)) %>%
  filter(Year %in% seq(2000, 2016, by = 1)) %>%
  mutate(Year = Year %>% droplevels()) %>%
  filter(NA_Sales > 0.000) %>%
  filter(!Publisher %in% c("NA", "N/A", "Unknown"))

str(video_games_data)

summary(video_games_data)

```

### Observations

+ 5 factor variables - Name, Platform, Year, Genre, Publisher  
+ 1 numeric variable - NA_Sales


Questions to be answered
========================
Company A want to know the feasibility of an online game streaming platform similar to ‘Netflix’ for games. They would like to know how to design their initial portfolio on the platform to generate maximum revenue.  

+ Should Company A tie up with a single publisher or platform?  
+ Which 3 top performing games should they include in their portfolio  
+ How should their portfolio split be in terms of game genres

Functions
==========

```{r, warning= FALSE, message= FALSE }
# Function to get the relevant grouped data frames
# df -> dataframe
# groupVariable -> the group by column 
# output -> the resulting data frame
getGroupedUnivariateData <- function(df, groupVariable) {
  # group_by() store
  # summarise() reduces variable to descriptive stat
  # count is the new variable name, n() is a counting function
  # percent is a new variable, sum() and nrow() are functions
  # tot_sales_units -> total number of units sold per store
  # tot_revenue -> total revenue per store
  # order_by() tot_revenue and tot_sales_units
  result <- df %>%             
    group_by_(groupVariable) %>%     
    summarise(count = n(),   
              percent = (sum(count) / nrow(df)) * 100, 
              tot_revenue = sum(NA_Sales),   
              avg_revenue = (mean(NA_Sales))) %>%
    arrange(desc(tot_revenue)) %>%
    as.data.frame() 
  
  return(result)
}
```

# I) Practical Analysis

1. Univariate non-graphical -- Categorical
===========================================

Categorical data - tabulation

### Platform

```{r, warning= FALSE, message= FALSE}
# sales and revenue by store
vg_platform <- getGroupedUnivariateData(video_games_data, "Platform")
vg_platform %>%
  kable() %>%
  kable_styling(bootstrap_options = c("striped", "hover")) %>%
  scroll_box(height = "300px")
```
### Observations

+ Top 5 Platforms by Total Revenue are X360, PS2, Wii, PS3, DS  
+ Maximum number of games on PS2(1620) and DS(1512)

### Year

```{r, warning= FALSE, message= FALSE}
# sales and revenue by store
vg_platform <- getGroupedUnivariateData(video_games_data, "Year")
vg_platform %>%
  kable() %>%
  kable_styling(bootstrap_options = c("striped", "hover")) %>%
  scroll_box(height = "300px")
```
### Observations

+ Top Years by Revenue are 2008, 2009, 2007 
+ Maximum number of games launched between 2007 to 2009

### Genre

```{r, warning= FALSE, message= FALSE}
# sales and revenue by store
vg_platform <- getGroupedUnivariateData(video_games_data, "Genre")
vg_platform %>%
  kable() %>%
  kable_styling(bootstrap_options = c("striped", "hover")) %>%
  scroll_box(height = "300px")
```
### Observations

+ Top 6 Genres are Action, Sports, Shooter, Misc, Role-Playing, Racing
+ The top 6 Genres make revenue more than 70% of the total genres

### Publisher 

```{r, warning= FALSE, message= FALSE}
# sales and revenue by store
vg_platform <- getGroupedUnivariateData(video_games_data, "Publisher")
vg_platform %>%
  kable() %>%
  kable_styling(bootstrap_options = c("striped", "hover")) %>%
  scroll_box(height = "300px")
```
### Observations

+ Top 5 Publishers are Electronic Arts, Nintendo, Activisions, Ubisoft, Take-Two Interactive   
+ Sony Computer Entertainment(406) and Konami Digital Entertainment(415) has more games but less Revenue than Nintendo and Take-Two Interactive


2. Univariate graphical -- Categorical
===========================================

Histograms


3. Univariate non-graphical -- Quantitative
============================================

Descriptive Statistics


4. Univariate graphical -- Quantitative
=========================================

Histograms


Boxplots


5. Multivariate non-graphical -- Categorical
============================================

Cross-Tabs


Proportion Cross-Tabs


6. Multivariate graphical code -- Categorical
==============================================

Grouped Summary graphs with more than 1 Categorical variables



7. Multivariate non-graphical -- Quantitative
==============================================

Correlation plots


8. Multivariate graphical code -- Quantitative
===============================================

Pairwise Plot



9. Multivariate non-graphical -- Categorical and Quantitative
=============================================================

matrix tables


10. Multivariate graphical -- Categorical and Quantitative
=============================================================

matrix group by and summarize quant graphs


# II) Statistical Analysis


Questions for statistical analysis
=========================================



Multiple Linear regression
================================

Summary
=======


Save Image of file
===================

```{r, warning= FALSE, message= FALSE }

# Save the rds file to reuse anything from this file in another file
save.image("TA.RData")
# recover using load()
# load("TA.RData")

```





